ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"packet_handler.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.ping,"ax",%progbits
  16              		.align	1
  17              		.global	ping
  18              		.arch armv7-m
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu softvfp
  24              	ping:
  25              	.LFB530:
  26              		.file 1 "Src/packet_handler.c"
   1:Src/packet_handler.c **** #include "packet_handler.h"
   2:Src/packet_handler.c **** #include "main.h"
   3:Src/packet_handler.c **** #include "port_handler.h"
   4:Src/packet_handler.c **** 
   5:Src/packet_handler.c **** /* Fields -------------------------------------------------------------------*/
   6:Src/packet_handler.c **** extern MessageQueue *message;
   7:Src/packet_handler.c **** uint8_t instruction;
   8:Src/packet_handler.c **** uint8_t param[20];
   9:Src/packet_handler.c **** uint8_t crc[2];
  10:Src/packet_handler.c **** extern Parameters *PARAM;
  11:Src/packet_handler.c **** int delay_transmit_uS = 50;
  12:Src/packet_handler.c **** 
  13:Src/packet_handler.c **** /* Methods ------------------------------------------------------------------*/
  14:Src/packet_handler.c **** 
  15:Src/packet_handler.c **** /* @brief Moves through queue to look for header block.
  16:Src/packet_handler.c ****  * 
  17:Src/packet_handler.c ****  * @param void 
  18:Src/packet_handler.c ****  * @return void
  19:Src/packet_handler.c ****  */
  20:Src/packet_handler.c **** void process_queue(){
  21:Src/packet_handler.c **** 
  22:Src/packet_handler.c ****     // header
  23:Src/packet_handler.c ****     uint8_t h1 = 0;
  24:Src/packet_handler.c ****     uint8_t h2 = 0;
  25:Src/packet_handler.c ****     uint8_t h3 = 0;
  26:Src/packet_handler.c ****     uint32_t header_block=0;
  27:Src/packet_handler.c ****     uint8_t header_block_found = 0;
  28:Src/packet_handler.c **** 
  29:Src/packet_handler.c ****     while (!header_block_found && !isEmpty(message)){
  30:Src/packet_handler.c **** 
  31:Src/packet_handler.c ****         // shift one byte
  32:Src/packet_handler.c ****         h1 = h2;
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 2


  33:Src/packet_handler.c ****         h2 = h3;
  34:Src/packet_handler.c ****         h3 = deQueue(message);
  35:Src/packet_handler.c ****         header_block = (h1<<16) + (h2<<8) + (h3);
  36:Src/packet_handler.c ****         if(header_block == 0xFFFFFD){
  37:Src/packet_handler.c ****             header_block_found = 1;
  38:Src/packet_handler.c ****         }
  39:Src/packet_handler.c ****     }
  40:Src/packet_handler.c ****     
  41:Src/packet_handler.c ****     if (header_block_found){
  42:Src/packet_handler.c ****         extract_message();
  43:Src/packet_handler.c ****     }
  44:Src/packet_handler.c **** 
  45:Src/packet_handler.c **** }
  46:Src/packet_handler.c **** 
  47:Src/packet_handler.c **** /* @brief After header block is found, extract reserved, id, length,
  48:Src/packet_handler.c ****  * instruction, and message parameters.
  49:Src/packet_handler.c ****  * 
  50:Src/packet_handler.c ****  * @param void 
  51:Src/packet_handler.c ****  * @return void
  52:Src/packet_handler.c ****  */
  53:Src/packet_handler.c **** void extract_message(){
  54:Src/packet_handler.c **** 
  55:Src/packet_handler.c ****     uint8_t reserved = deQueue(message);
  56:Src/packet_handler.c ****     uint8_t id = deQueue(message);
  57:Src/packet_handler.c ****     uint8_t length1 = deQueue(message);
  58:Src/packet_handler.c ****     uint8_t length2 = deQueue(message);
  59:Src/packet_handler.c ****     uint16_t length = (length2 << 8) + (length1);
  60:Src/packet_handler.c ****     instruction = deQueue(message);
  61:Src/packet_handler.c ****     int i;
  62:Src/packet_handler.c ****     if(length<10){
  63:Src/packet_handler.c ****         // grab the parameters
  64:Src/packet_handler.c ****         for (i=0; i< (length-3); i++){
  65:Src/packet_handler.c ****             param[i] = deQueue(message);
  66:Src/packet_handler.c ****         }
  67:Src/packet_handler.c ****     }
  68:Src/packet_handler.c ****     // grab CRC used for checking data loss
  69:Src/packet_handler.c ****     crc[0] = deQueue(message);
  70:Src/packet_handler.c ****     crc[1] = deQueue(message);
  71:Src/packet_handler.c **** 
  72:Src/packet_handler.c ****     // message fully received, proccess
  73:Src/packet_handler.c ****     if (id==PARAM->ID){
  74:Src/packet_handler.c ****         process_message();
  75:Src/packet_handler.c ****     }
  76:Src/packet_handler.c **** 
  77:Src/packet_handler.c **** }
  78:Src/packet_handler.c **** 
  79:Src/packet_handler.c **** /* @brief Execute the response for message.
  80:Src/packet_handler.c ****  * 
  81:Src/packet_handler.c ****  * @param void 
  82:Src/packet_handler.c ****  * @return void
  83:Src/packet_handler.c ****  */
  84:Src/packet_handler.c **** void process_message(){
  85:Src/packet_handler.c ****     // TODO: calculate delay time based on UART baud rate. 
  86:Src/packet_handler.c ****     /* Important to have small delay to ensure master is ready to receive*/
  87:Src/packet_handler.c ****     DWT_Delay(delay_transmit_uS);
  88:Src/packet_handler.c ****     delay_transmit_uS += 50;
  89:Src/packet_handler.c ****     switch (instruction){
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 3


  90:Src/packet_handler.c ****         case PING: ping(); break;
  91:Src/packet_handler.c ****         case READ : read(); break;
  92:Src/packet_handler.c ****         case WRITE : write(); break;
  93:Src/packet_handler.c ****         case REG_WRITE : reg_write(); break;
  94:Src/packet_handler.c ****         case ACTION : action(); break;
  95:Src/packet_handler.c ****         case FACTORY_RESET : factory_reset(); break;        
  96:Src/packet_handler.c ****         case REBOOT : reboot(); break;
  97:Src/packet_handler.c ****         case CLEAR  : clear(); break;
  98:Src/packet_handler.c ****         case STATUS  : status(); break;
  99:Src/packet_handler.c ****         case SYNC_READ  : sync_read(); break;
 100:Src/packet_handler.c ****         case SYNC_WRITE  : sync_write(); break;
 101:Src/packet_handler.c ****         case BULK_READ  : bulk_read(); break;
 102:Src/packet_handler.c ****         case BULK_WRITE  : bulk_write(); break;
 103:Src/packet_handler.c ****     }
 104:Src/packet_handler.c **** 
 105:Src/packet_handler.c **** }
 106:Src/packet_handler.c **** 
 107:Src/packet_handler.c **** // TODO: finish instruction
 108:Src/packet_handler.c **** void ping(){    
  27              		.loc 1 108 12 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 16
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 10B5     		push	{r4, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 8
  34              		.cfi_offset 4, -8
  35              		.cfi_offset 14, -4
  36 0002 84B0     		sub	sp, sp, #16
  37              	.LCFI1:
  38              		.cfi_def_cfa_offset 24
 109:Src/packet_handler.c ****     uint8_t response[] = {0xFF, 0xFF, 0xFD, 0x00, 0x01, 0x07, 0x00, 0x55, 0x00, 0x06, 0x04, 0x26, 0
  39              		.loc 1 109 5 view .LVU1
  40              		.loc 1 109 13 is_stmt 0 view .LVU2
  41 0004 054B     		ldr	r3, .L3
  42 0006 6C46     		mov	r4, sp
  43 0008 0FCB     		ldm	r3, {r0, r1, r2, r3}
  44 000a 07C4     		stmia	r4!, {r0, r1, r2}
  45 000c 2380     		strh	r3, [r4]	@ movhi
 110:Src/packet_handler.c ****     transmit_buffer(response, sizeof(response));
  46              		.loc 1 110 5 is_stmt 1 view .LVU3
  47 000e 0E21     		movs	r1, #14
  48 0010 6846     		mov	r0, sp
  49 0012 FFF7FEFF 		bl	transmit_buffer
  50              	.LVL0:
 111:Src/packet_handler.c **** }
  51              		.loc 1 111 1 is_stmt 0 view .LVU4
  52 0016 04B0     		add	sp, sp, #16
  53              	.LCFI2:
  54              		.cfi_def_cfa_offset 8
  55              		@ sp needed
  56 0018 10BD     		pop	{r4, pc}
  57              	.L4:
  58 001a 00BF     		.align	2
  59              	.L3:
  60 001c 00000000 		.word	.LANCHOR0
  61              		.cfi_endproc
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 4


  62              	.LFE530:
  64              		.section	.text.process_message,"ax",%progbits
  65              		.align	1
  66              		.global	process_message
  67              		.syntax unified
  68              		.thumb
  69              		.thumb_func
  70              		.fpu softvfp
  72              	process_message:
  73              	.LFB529:
  84:Src/packet_handler.c ****     // TODO: calculate delay time based on UART baud rate. 
  74              		.loc 1 84 23 is_stmt 1 view -0
  75              		.cfi_startproc
  76              		@ args = 0, pretend = 0, frame = 0
  77              		@ frame_needed = 0, uses_anonymous_args = 0
  78 0000 10B5     		push	{r4, lr}
  79              	.LCFI3:
  80              		.cfi_def_cfa_offset 8
  81              		.cfi_offset 4, -8
  82              		.cfi_offset 14, -4
  87:Src/packet_handler.c ****     delay_transmit_uS += 50;
  83              		.loc 1 87 5 view .LVU6
  84 0002 074C     		ldr	r4, .L9
  85 0004 2068     		ldr	r0, [r4]
  86 0006 FFF7FEFF 		bl	DWT_Delay
  87              	.LVL1:
  88:Src/packet_handler.c ****     switch (instruction){
  88              		.loc 1 88 5 view .LVU7
  88:Src/packet_handler.c ****     switch (instruction){
  89              		.loc 1 88 23 is_stmt 0 view .LVU8
  90 000a 2368     		ldr	r3, [r4]
  91 000c 3233     		adds	r3, r3, #50
  92 000e 2360     		str	r3, [r4]
  89:Src/packet_handler.c ****         case PING: ping(); break;
  93              		.loc 1 89 5 is_stmt 1 view .LVU9
  94 0010 044B     		ldr	r3, .L9+4
  95 0012 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  96 0014 012B     		cmp	r3, #1
  97 0016 00D0     		beq	.L8
  98              	.L5:
 105:Src/packet_handler.c **** 
  99              		.loc 1 105 1 is_stmt 0 view .LVU10
 100 0018 10BD     		pop	{r4, pc}
 101              	.L8:
  90:Src/packet_handler.c ****         case READ : read(); break;
 102              		.loc 1 90 20 is_stmt 1 view .LVU11
 103 001a FFF7FEFF 		bl	ping
 104              	.LVL2:
  90:Src/packet_handler.c ****         case READ : read(); break;
 105              		.loc 1 90 28 view .LVU12
 105:Src/packet_handler.c **** 
 106              		.loc 1 105 1 is_stmt 0 view .LVU13
 107 001e FBE7     		b	.L5
 108              	.L10:
 109              		.align	2
 110              	.L9:
 111 0020 00000000 		.word	.LANCHOR1
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 5


 112 0024 00000000 		.word	instruction
 113              		.cfi_endproc
 114              	.LFE529:
 116              		.section	.text.extract_message,"ax",%progbits
 117              		.align	1
 118              		.global	extract_message
 119              		.syntax unified
 120              		.thumb
 121              		.thumb_func
 122              		.fpu softvfp
 124              	extract_message:
 125              	.LFB528:
  53:Src/packet_handler.c **** 
 126              		.loc 1 53 23 is_stmt 1 view -0
 127              		.cfi_startproc
 128              		@ args = 0, pretend = 0, frame = 0
 129              		@ frame_needed = 0, uses_anonymous_args = 0
 130 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 131              	.LCFI4:
 132              		.cfi_def_cfa_offset 24
 133              		.cfi_offset 3, -24
 134              		.cfi_offset 4, -20
 135              		.cfi_offset 5, -16
 136              		.cfi_offset 6, -12
 137              		.cfi_offset 7, -8
 138              		.cfi_offset 14, -4
  55:Src/packet_handler.c ****     uint8_t id = deQueue(message);
 139              		.loc 1 55 5 view .LVU15
  55:Src/packet_handler.c ****     uint8_t id = deQueue(message);
 140              		.loc 1 55 24 is_stmt 0 view .LVU16
 141 0002 1D4C     		ldr	r4, .L19
 142 0004 2068     		ldr	r0, [r4]
 143 0006 FFF7FEFF 		bl	deQueue
 144              	.LVL3:
  56:Src/packet_handler.c ****     uint8_t length1 = deQueue(message);
 145              		.loc 1 56 5 is_stmt 1 view .LVU17
  56:Src/packet_handler.c ****     uint8_t length1 = deQueue(message);
 146              		.loc 1 56 18 is_stmt 0 view .LVU18
 147 000a 2068     		ldr	r0, [r4]
 148 000c FFF7FEFF 		bl	deQueue
 149              	.LVL4:
 150 0010 0646     		mov	r6, r0
 151              	.LVL5:
  57:Src/packet_handler.c ****     uint8_t length2 = deQueue(message);
 152              		.loc 1 57 5 is_stmt 1 view .LVU19
  57:Src/packet_handler.c ****     uint8_t length2 = deQueue(message);
 153              		.loc 1 57 23 is_stmt 0 view .LVU20
 154 0012 2068     		ldr	r0, [r4]
 155 0014 FFF7FEFF 		bl	deQueue
 156              	.LVL6:
 157 0018 0746     		mov	r7, r0
 158              	.LVL7:
  58:Src/packet_handler.c ****     uint16_t length = (length2 << 8) + (length1);
 159              		.loc 1 58 5 is_stmt 1 view .LVU21
  58:Src/packet_handler.c ****     uint16_t length = (length2 << 8) + (length1);
 160              		.loc 1 58 23 is_stmt 0 view .LVU22
 161 001a 2068     		ldr	r0, [r4]
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 6


 162 001c FFF7FEFF 		bl	deQueue
 163              	.LVL8:
  59:Src/packet_handler.c ****     instruction = deQueue(message);
 164              		.loc 1 59 5 is_stmt 1 view .LVU23
  59:Src/packet_handler.c ****     instruction = deQueue(message);
 165              		.loc 1 59 32 is_stmt 0 view .LVU24
 166 0020 0502     		lsls	r5, r0, #8
 167 0022 ADB2     		uxth	r5, r5
  59:Src/packet_handler.c ****     instruction = deQueue(message);
 168              		.loc 1 59 38 view .LVU25
 169 0024 BFB2     		uxth	r7, r7
 170              	.LVL9:
  59:Src/packet_handler.c ****     instruction = deQueue(message);
 171              		.loc 1 59 14 view .LVU26
 172 0026 3D44     		add	r5, r5, r7
 173 0028 ADB2     		uxth	r5, r5
 174              	.LVL10:
  60:Src/packet_handler.c ****     int i;
 175              		.loc 1 60 5 is_stmt 1 view .LVU27
  60:Src/packet_handler.c ****     int i;
 176              		.loc 1 60 19 is_stmt 0 view .LVU28
 177 002a 2068     		ldr	r0, [r4]
 178              	.LVL11:
  60:Src/packet_handler.c ****     int i;
 179              		.loc 1 60 19 view .LVU29
 180 002c FFF7FEFF 		bl	deQueue
 181              	.LVL12:
  60:Src/packet_handler.c ****     int i;
 182              		.loc 1 60 17 view .LVU30
 183 0030 124B     		ldr	r3, .L19+4
 184 0032 1870     		strb	r0, [r3]
  61:Src/packet_handler.c ****     if(length<10){
 185              		.loc 1 61 5 is_stmt 1 view .LVU31
  62:Src/packet_handler.c ****         // grab the parameters
 186              		.loc 1 62 5 view .LVU32
  62:Src/packet_handler.c ****         // grab the parameters
 187              		.loc 1 62 7 is_stmt 0 view .LVU33
 188 0034 092D     		cmp	r5, #9
 189 0036 0FD9     		bls	.L16
 190              	.L13:
  69:Src/packet_handler.c ****     crc[1] = deQueue(message);
 191              		.loc 1 69 5 is_stmt 1 view .LVU34
  69:Src/packet_handler.c ****     crc[1] = deQueue(message);
 192              		.loc 1 69 14 is_stmt 0 view .LVU35
 193 0038 0F4D     		ldr	r5, .L19
 194              	.LVL13:
  69:Src/packet_handler.c ****     crc[1] = deQueue(message);
 195              		.loc 1 69 14 view .LVU36
 196 003a 2868     		ldr	r0, [r5]
 197 003c FFF7FEFF 		bl	deQueue
 198              	.LVL14:
  69:Src/packet_handler.c ****     crc[1] = deQueue(message);
 199              		.loc 1 69 12 view .LVU37
 200 0040 0F4C     		ldr	r4, .L19+8
 201 0042 2070     		strb	r0, [r4]
  70:Src/packet_handler.c **** 
 202              		.loc 1 70 5 is_stmt 1 view .LVU38
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 7


  70:Src/packet_handler.c **** 
 203              		.loc 1 70 14 is_stmt 0 view .LVU39
 204 0044 2868     		ldr	r0, [r5]
 205 0046 FFF7FEFF 		bl	deQueue
 206              	.LVL15:
  70:Src/packet_handler.c **** 
 207              		.loc 1 70 12 view .LVU40
 208 004a 6070     		strb	r0, [r4, #1]
  73:Src/packet_handler.c ****         process_message();
 209              		.loc 1 73 5 is_stmt 1 view .LVU41
  73:Src/packet_handler.c ****         process_message();
 210              		.loc 1 73 18 is_stmt 0 view .LVU42
 211 004c 0D4B     		ldr	r3, .L19+12
 212 004e 1B68     		ldr	r3, [r3]
 213 0050 1B68     		ldr	r3, [r3]
  73:Src/packet_handler.c ****         process_message();
 214              		.loc 1 73 8 view .LVU43
 215 0052 9E42     		cmp	r6, r3
 216 0054 0CD0     		beq	.L18
 217              	.L11:
  77:Src/packet_handler.c **** 
 218              		.loc 1 77 1 view .LVU44
 219 0056 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 220              	.LVL16:
 221              	.L16:
  64:Src/packet_handler.c ****             param[i] = deQueue(message);
 222              		.loc 1 64 15 view .LVU45
 223 0058 0024     		movs	r4, #0
 224              	.L12:
 225              	.LVL17:
  64:Src/packet_handler.c ****             param[i] = deQueue(message);
 226              		.loc 1 64 19 is_stmt 1 discriminator 1 view .LVU46
  64:Src/packet_handler.c ****             param[i] = deQueue(message);
 227              		.loc 1 64 29 is_stmt 0 discriminator 1 view .LVU47
 228 005a EB1E     		subs	r3, r5, #3
  64:Src/packet_handler.c ****             param[i] = deQueue(message);
 229              		.loc 1 64 9 discriminator 1 view .LVU48
 230 005c A342     		cmp	r3, r4
 231 005e EBDD     		ble	.L13
  65:Src/packet_handler.c ****         }
 232              		.loc 1 65 13 is_stmt 1 discriminator 3 view .LVU49
  65:Src/packet_handler.c ****         }
 233              		.loc 1 65 24 is_stmt 0 discriminator 3 view .LVU50
 234 0060 054B     		ldr	r3, .L19
 235 0062 1868     		ldr	r0, [r3]
 236 0064 FFF7FEFF 		bl	deQueue
 237              	.LVL18:
  65:Src/packet_handler.c ****         }
 238              		.loc 1 65 22 discriminator 3 view .LVU51
 239 0068 074B     		ldr	r3, .L19+16
 240 006a 1855     		strb	r0, [r3, r4]
  64:Src/packet_handler.c ****             param[i] = deQueue(message);
 241              		.loc 1 64 34 is_stmt 1 discriminator 3 view .LVU52
  64:Src/packet_handler.c ****             param[i] = deQueue(message);
 242              		.loc 1 64 35 is_stmt 0 discriminator 3 view .LVU53
 243 006c 0134     		adds	r4, r4, #1
 244              	.LVL19:
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 8


  64:Src/packet_handler.c ****             param[i] = deQueue(message);
 245              		.loc 1 64 35 discriminator 3 view .LVU54
 246 006e F4E7     		b	.L12
 247              	.LVL20:
 248              	.L18:
  74:Src/packet_handler.c ****     }
 249              		.loc 1 74 9 is_stmt 1 view .LVU55
 250 0070 FFF7FEFF 		bl	process_message
 251              	.LVL21:
  77:Src/packet_handler.c **** 
 252              		.loc 1 77 1 is_stmt 0 view .LVU56
 253 0074 EFE7     		b	.L11
 254              	.L20:
 255 0076 00BF     		.align	2
 256              	.L19:
 257 0078 00000000 		.word	message
 258 007c 00000000 		.word	instruction
 259 0080 00000000 		.word	crc
 260 0084 00000000 		.word	PARAM
 261 0088 00000000 		.word	param
 262              		.cfi_endproc
 263              	.LFE528:
 265              		.section	.text.process_queue,"ax",%progbits
 266              		.align	1
 267              		.global	process_queue
 268              		.syntax unified
 269              		.thumb
 270              		.thumb_func
 271              		.fpu softvfp
 273              	process_queue:
 274              	.LFB527:
  20:Src/packet_handler.c **** 
 275              		.loc 1 20 21 is_stmt 1 view -0
 276              		.cfi_startproc
 277              		@ args = 0, pretend = 0, frame = 0
 278              		@ frame_needed = 0, uses_anonymous_args = 0
 279 0000 70B5     		push	{r4, r5, r6, lr}
 280              	.LCFI5:
 281              		.cfi_def_cfa_offset 16
 282              		.cfi_offset 4, -16
 283              		.cfi_offset 5, -12
 284              		.cfi_offset 6, -8
 285              		.cfi_offset 14, -4
  23:Src/packet_handler.c ****     uint8_t h2 = 0;
 286              		.loc 1 23 5 view .LVU58
 287              	.LVL22:
  24:Src/packet_handler.c ****     uint8_t h3 = 0;
 288              		.loc 1 24 5 view .LVU59
  25:Src/packet_handler.c ****     uint32_t header_block=0;
 289              		.loc 1 25 5 view .LVU60
  26:Src/packet_handler.c ****     uint8_t header_block_found = 0;
 290              		.loc 1 26 5 view .LVU61
  27:Src/packet_handler.c **** 
 291              		.loc 1 27 5 view .LVU62
  29:Src/packet_handler.c **** 
 292              		.loc 1 29 5 view .LVU63
  27:Src/packet_handler.c **** 
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 9


 293              		.loc 1 27 13 is_stmt 0 view .LVU64
 294 0002 0026     		movs	r6, #0
  25:Src/packet_handler.c ****     uint32_t header_block=0;
 295              		.loc 1 25 13 view .LVU65
 296 0004 3446     		mov	r4, r6
  24:Src/packet_handler.c ****     uint8_t h3 = 0;
 297              		.loc 1 24 13 view .LVU66
 298 0006 3546     		mov	r5, r6
  29:Src/packet_handler.c **** 
 299              		.loc 1 29 11 view .LVU67
 300 0008 01E0     		b	.L22
 301              	.LVL23:
 302              	.L23:
  37:Src/packet_handler.c ****         }
 303              		.loc 1 37 32 view .LVU68
 304 000a 2546     		mov	r5, r4
 305              	.LVL24:
  37:Src/packet_handler.c ****         }
 306              		.loc 1 37 32 view .LVU69
 307 000c 0446     		mov	r4, r0
 308              	.LVL25:
 309              	.L22:
  29:Src/packet_handler.c **** 
 310              		.loc 1 29 11 is_stmt 1 view .LVU70
 311 000e 8EB9     		cbnz	r6, .L24
  29:Src/packet_handler.c **** 
 312              		.loc 1 29 36 is_stmt 0 discriminator 1 view .LVU71
 313 0010 0B4B     		ldr	r3, .L30
 314 0012 1868     		ldr	r0, [r3]
 315 0014 FFF7FEFF 		bl	isEmpty
 316              	.LVL26:
  29:Src/packet_handler.c **** 
 317              		.loc 1 29 32 discriminator 1 view .LVU72
 318 0018 60B9     		cbnz	r0, .L24
  32:Src/packet_handler.c ****         h2 = h3;
 319              		.loc 1 32 9 is_stmt 1 view .LVU73
 320              	.LVL27:
  33:Src/packet_handler.c ****         h3 = deQueue(message);
 321              		.loc 1 33 9 view .LVU74
  34:Src/packet_handler.c ****         header_block = (h1<<16) + (h2<<8) + (h3);
 322              		.loc 1 34 9 view .LVU75
  34:Src/packet_handler.c ****         header_block = (h1<<16) + (h2<<8) + (h3);
 323              		.loc 1 34 14 is_stmt 0 view .LVU76
 324 001a 094B     		ldr	r3, .L30
 325 001c 1868     		ldr	r0, [r3]
 326 001e FFF7FEFF 		bl	deQueue
 327              	.LVL28:
  35:Src/packet_handler.c ****         if(header_block == 0xFFFFFD){
 328              		.loc 1 35 9 is_stmt 1 view .LVU77
  35:Src/packet_handler.c ****         if(header_block == 0xFFFFFD){
 329              		.loc 1 35 38 is_stmt 0 view .LVU78
 330 0022 2302     		lsls	r3, r4, #8
  35:Src/packet_handler.c ****         if(header_block == 0xFFFFFD){
 331              		.loc 1 35 33 view .LVU79
 332 0024 03EB0543 		add	r3, r3, r5, lsl #16
  35:Src/packet_handler.c ****         if(header_block == 0xFFFFFD){
 333              		.loc 1 35 43 view .LVU80
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 10


 334 0028 0344     		add	r3, r3, r0
 335              	.LVL29:
  36:Src/packet_handler.c ****             header_block_found = 1;
 336              		.loc 1 36 9 is_stmt 1 view .LVU81
  36:Src/packet_handler.c ****             header_block_found = 1;
 337              		.loc 1 36 11 is_stmt 0 view .LVU82
 338 002a 064A     		ldr	r2, .L30+4
 339 002c 9342     		cmp	r3, r2
 340 002e ECD1     		bne	.L23
  37:Src/packet_handler.c ****         }
 341              		.loc 1 37 32 view .LVU83
 342 0030 0126     		movs	r6, #1
 343              	.LVL30:
  37:Src/packet_handler.c ****         }
 344              		.loc 1 37 32 view .LVU84
 345 0032 EAE7     		b	.L23
 346              	.LVL31:
 347              	.L24:
  41:Src/packet_handler.c ****         extract_message();
 348              		.loc 1 41 5 is_stmt 1 view .LVU85
  41:Src/packet_handler.c ****         extract_message();
 349              		.loc 1 41 8 is_stmt 0 view .LVU86
 350 0034 06B9     		cbnz	r6, .L29
 351              	.L21:
  45:Src/packet_handler.c **** 
 352              		.loc 1 45 1 view .LVU87
 353 0036 70BD     		pop	{r4, r5, r6, pc}
 354              	.LVL32:
 355              	.L29:
 356              	.LBB2:
  42:Src/packet_handler.c ****     }
 357              		.loc 1 42 9 is_stmt 1 view .LVU88
 358 0038 FFF7FEFF 		bl	extract_message
 359              	.LVL33:
 360              	.LBE2:
  45:Src/packet_handler.c **** 
 361              		.loc 1 45 1 is_stmt 0 view .LVU89
 362 003c FBE7     		b	.L21
 363              	.L31:
 364 003e 00BF     		.align	2
 365              	.L30:
 366 0040 00000000 		.word	message
 367 0044 FDFFFF00 		.word	16777213
 368              		.cfi_endproc
 369              	.LFE527:
 371              		.section	.text.read,"ax",%progbits
 372              		.align	1
 373              		.global	read
 374              		.syntax unified
 375              		.thumb
 376              		.thumb_func
 377              		.fpu softvfp
 379              	read:
 380              	.LFB531:
 112:Src/packet_handler.c **** 
 113:Src/packet_handler.c **** // TODO: finish instruction
 114:Src/packet_handler.c **** void read(void){
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 11


 381              		.loc 1 114 16 is_stmt 1 view -0
 382              		.cfi_startproc
 383              		@ args = 0, pretend = 0, frame = 0
 384              		@ frame_needed = 0, uses_anonymous_args = 0
 385              		@ link register save eliminated.
 115:Src/packet_handler.c **** 
 116:Src/packet_handler.c **** }
 386              		.loc 1 116 1 view .LVU91
 387 0000 7047     		bx	lr
 388              		.cfi_endproc
 389              	.LFE531:
 391              		.section	.text.write,"ax",%progbits
 392              		.align	1
 393              		.global	write
 394              		.syntax unified
 395              		.thumb
 396              		.thumb_func
 397              		.fpu softvfp
 399              	write:
 400              	.LFB532:
 117:Src/packet_handler.c **** 
 118:Src/packet_handler.c **** // TODO: finish instruction
 119:Src/packet_handler.c **** void write(void){
 401              		.loc 1 119 17 view -0
 402              		.cfi_startproc
 403              		@ args = 0, pretend = 0, frame = 0
 404              		@ frame_needed = 0, uses_anonymous_args = 0
 405              		@ link register save eliminated.
 120:Src/packet_handler.c **** 
 121:Src/packet_handler.c **** }
 406              		.loc 1 121 1 view .LVU93
 407 0000 7047     		bx	lr
 408              		.cfi_endproc
 409              	.LFE532:
 411              		.section	.text.reg_write,"ax",%progbits
 412              		.align	1
 413              		.global	reg_write
 414              		.syntax unified
 415              		.thumb
 416              		.thumb_func
 417              		.fpu softvfp
 419              	reg_write:
 420              	.LFB533:
 122:Src/packet_handler.c **** 
 123:Src/packet_handler.c **** // TODO: finish instruction
 124:Src/packet_handler.c **** void reg_write(void){
 421              		.loc 1 124 21 view -0
 422              		.cfi_startproc
 423              		@ args = 0, pretend = 0, frame = 0
 424              		@ frame_needed = 0, uses_anonymous_args = 0
 425              		@ link register save eliminated.
 125:Src/packet_handler.c ****     
 126:Src/packet_handler.c **** }
 426              		.loc 1 126 1 view .LVU95
 427 0000 7047     		bx	lr
 428              		.cfi_endproc
 429              	.LFE533:
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 12


 431              		.section	.text.action,"ax",%progbits
 432              		.align	1
 433              		.global	action
 434              		.syntax unified
 435              		.thumb
 436              		.thumb_func
 437              		.fpu softvfp
 439              	action:
 440              	.LFB534:
 127:Src/packet_handler.c **** 
 128:Src/packet_handler.c **** // TODO: finish instruction
 129:Src/packet_handler.c **** void action(void){
 441              		.loc 1 129 18 view -0
 442              		.cfi_startproc
 443              		@ args = 0, pretend = 0, frame = 0
 444              		@ frame_needed = 0, uses_anonymous_args = 0
 445              		@ link register save eliminated.
 130:Src/packet_handler.c ****     
 131:Src/packet_handler.c **** }
 446              		.loc 1 131 1 view .LVU97
 447 0000 7047     		bx	lr
 448              		.cfi_endproc
 449              	.LFE534:
 451              		.section	.text.factory_reset,"ax",%progbits
 452              		.align	1
 453              		.global	factory_reset
 454              		.syntax unified
 455              		.thumb
 456              		.thumb_func
 457              		.fpu softvfp
 459              	factory_reset:
 460              	.LFB535:
 132:Src/packet_handler.c **** 
 133:Src/packet_handler.c **** // TODO: finish instruction
 134:Src/packet_handler.c **** void factory_reset(void){
 461              		.loc 1 134 25 view -0
 462              		.cfi_startproc
 463              		@ args = 0, pretend = 0, frame = 0
 464              		@ frame_needed = 0, uses_anonymous_args = 0
 465              		@ link register save eliminated.
 135:Src/packet_handler.c ****     
 136:Src/packet_handler.c **** }
 466              		.loc 1 136 1 view .LVU99
 467 0000 7047     		bx	lr
 468              		.cfi_endproc
 469              	.LFE535:
 471              		.section	.text.reboot,"ax",%progbits
 472              		.align	1
 473              		.global	reboot
 474              		.syntax unified
 475              		.thumb
 476              		.thumb_func
 477              		.fpu softvfp
 479              	reboot:
 480              	.LFB536:
 137:Src/packet_handler.c **** 
 138:Src/packet_handler.c **** // TODO: finish instruction
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 13


 139:Src/packet_handler.c **** void reboot(void){
 481              		.loc 1 139 18 view -0
 482              		.cfi_startproc
 483              		@ args = 0, pretend = 0, frame = 0
 484              		@ frame_needed = 0, uses_anonymous_args = 0
 485              		@ link register save eliminated.
 140:Src/packet_handler.c ****     
 141:Src/packet_handler.c **** }
 486              		.loc 1 141 1 view .LVU101
 487 0000 7047     		bx	lr
 488              		.cfi_endproc
 489              	.LFE536:
 491              		.section	.text.clear,"ax",%progbits
 492              		.align	1
 493              		.global	clear
 494              		.syntax unified
 495              		.thumb
 496              		.thumb_func
 497              		.fpu softvfp
 499              	clear:
 500              	.LFB537:
 142:Src/packet_handler.c **** 
 143:Src/packet_handler.c **** // TODO: finish instruction
 144:Src/packet_handler.c **** void clear(void){
 501              		.loc 1 144 17 view -0
 502              		.cfi_startproc
 503              		@ args = 0, pretend = 0, frame = 0
 504              		@ frame_needed = 0, uses_anonymous_args = 0
 505              		@ link register save eliminated.
 145:Src/packet_handler.c ****     
 146:Src/packet_handler.c **** }
 506              		.loc 1 146 1 view .LVU103
 507 0000 7047     		bx	lr
 508              		.cfi_endproc
 509              	.LFE537:
 511              		.section	.text.status,"ax",%progbits
 512              		.align	1
 513              		.global	status
 514              		.syntax unified
 515              		.thumb
 516              		.thumb_func
 517              		.fpu softvfp
 519              	status:
 520              	.LFB538:
 147:Src/packet_handler.c **** 
 148:Src/packet_handler.c **** // TODO: finish instruction
 149:Src/packet_handler.c **** void status(void){
 521              		.loc 1 149 18 view -0
 522              		.cfi_startproc
 523              		@ args = 0, pretend = 0, frame = 0
 524              		@ frame_needed = 0, uses_anonymous_args = 0
 525              		@ link register save eliminated.
 150:Src/packet_handler.c ****     
 151:Src/packet_handler.c **** }
 526              		.loc 1 151 1 view .LVU105
 527 0000 7047     		bx	lr
 528              		.cfi_endproc
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 14


 529              	.LFE538:
 531              		.section	.text.sync_read,"ax",%progbits
 532              		.align	1
 533              		.global	sync_read
 534              		.syntax unified
 535              		.thumb
 536              		.thumb_func
 537              		.fpu softvfp
 539              	sync_read:
 540              	.LFB539:
 152:Src/packet_handler.c **** 
 153:Src/packet_handler.c **** // TODO: finish instruction
 154:Src/packet_handler.c **** void sync_read(void){
 541              		.loc 1 154 21 view -0
 542              		.cfi_startproc
 543              		@ args = 0, pretend = 0, frame = 0
 544              		@ frame_needed = 0, uses_anonymous_args = 0
 545              		@ link register save eliminated.
 155:Src/packet_handler.c ****     
 156:Src/packet_handler.c **** }
 546              		.loc 1 156 1 view .LVU107
 547 0000 7047     		bx	lr
 548              		.cfi_endproc
 549              	.LFE539:
 551              		.section	.text.sync_write,"ax",%progbits
 552              		.align	1
 553              		.global	sync_write
 554              		.syntax unified
 555              		.thumb
 556              		.thumb_func
 557              		.fpu softvfp
 559              	sync_write:
 560              	.LFB540:
 157:Src/packet_handler.c **** 
 158:Src/packet_handler.c **** // TODO: finish instruction
 159:Src/packet_handler.c **** void sync_write(void){
 561              		.loc 1 159 22 view -0
 562              		.cfi_startproc
 563              		@ args = 0, pretend = 0, frame = 0
 564              		@ frame_needed = 0, uses_anonymous_args = 0
 565              		@ link register save eliminated.
 160:Src/packet_handler.c ****     
 161:Src/packet_handler.c **** }
 566              		.loc 1 161 1 view .LVU109
 567 0000 7047     		bx	lr
 568              		.cfi_endproc
 569              	.LFE540:
 571              		.section	.text.bulk_read,"ax",%progbits
 572              		.align	1
 573              		.global	bulk_read
 574              		.syntax unified
 575              		.thumb
 576              		.thumb_func
 577              		.fpu softvfp
 579              	bulk_read:
 580              	.LFB541:
 162:Src/packet_handler.c **** 
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 15


 163:Src/packet_handler.c **** // TODO: finish instruction
 164:Src/packet_handler.c **** void bulk_read(void){
 581              		.loc 1 164 21 view -0
 582              		.cfi_startproc
 583              		@ args = 0, pretend = 0, frame = 0
 584              		@ frame_needed = 0, uses_anonymous_args = 0
 585              		@ link register save eliminated.
 165:Src/packet_handler.c ****     
 166:Src/packet_handler.c **** }
 586              		.loc 1 166 1 view .LVU111
 587 0000 7047     		bx	lr
 588              		.cfi_endproc
 589              	.LFE541:
 591              		.section	.text.bulk_write,"ax",%progbits
 592              		.align	1
 593              		.global	bulk_write
 594              		.syntax unified
 595              		.thumb
 596              		.thumb_func
 597              		.fpu softvfp
 599              	bulk_write:
 600              	.LFB542:
 167:Src/packet_handler.c **** 
 168:Src/packet_handler.c **** // TODO: finish instruction
 169:Src/packet_handler.c **** void bulk_write(void){
 601              		.loc 1 169 22 view -0
 602              		.cfi_startproc
 603              		@ args = 0, pretend = 0, frame = 0
 604              		@ frame_needed = 0, uses_anonymous_args = 0
 605              		@ link register save eliminated.
 170:Src/packet_handler.c ****     
 171:Src/packet_handler.c **** }
 606              		.loc 1 171 1 view .LVU113
 607 0000 7047     		bx	lr
 608              		.cfi_endproc
 609              	.LFE542:
 611              		.global	delay_transmit_uS
 612              		.comm	crc,2,4
 613              		.comm	param,20,4
 614              		.comm	instruction,1,1
 615              		.comm	rd_ptr,1,1
 616              		.comm	txBuffer,32,4
 617              		.comm	rxBuffer,64,4
 618              		.section	.rodata
 619              		.align	2
 620              		.set	.LANCHOR0,. + 0
 621              	.LC0:
 622 0000 FFFFFD00 		.ascii	"\377\377\375\000\001\007\000U\000\006\004&e]"
 622      01070055 
 622      00060426 
 622      655D
 623              		.section	.data.delay_transmit_uS,"aw"
 624              		.align	2
 625              		.set	.LANCHOR1,. + 0
 628              	delay_transmit_uS:
 629 0000 32000000 		.word	50
 630              		.text
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 16


 631              	.Letext0:
 632              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\9 2019-q4-major\\arm-none-eabi\\include\
 633              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\9 2019-q4-major\\arm-none-eabi\\include\
 634              		.file 4 "c:\\program files (x86)\\gnu tools arm embedded\\9 2019-q4-major\\arm-none-eabi\\include\
 635              		.file 5 "c:\\program files (x86)\\gnu tools arm embedded\\9 2019-q4-major\\arm-none-eabi\\include\
 636              		.file 6 "c:\\program files (x86)\\gnu tools arm embedded\\9 2019-q4-major\\lib\\gcc\\arm-none-eabi
 637              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\9 2019-q4-major\\arm-none-eabi\\include\
 638              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\9 2019-q4-major\\arm-none-eabi\\include\
 639              		.file 9 "Inc/queue.h"
 640              		.file 10 "Drivers/CMSIS/Include/core_cm3.h"
 641              		.file 11 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/system_stm32f1xx.h"
 642              		.file 12 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal.h"
 643              		.file 13 "Inc/port_handler.h"
 644              		.file 14 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_ll_dma.h"
ARM GAS  C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s 			page 17


DEFINED SYMBOLS
                            *ABS*:00000000 packet_handler.c
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:16     .text.ping:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:24     .text.ping:00000000 ping
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:60     .text.ping:0000001c $d
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:65     .text.process_message:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:72     .text.process_message:00000000 process_message
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:111    .text.process_message:00000020 $d
                            *COM*:00000001 instruction
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:117    .text.extract_message:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:124    .text.extract_message:00000000 extract_message
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:257    .text.extract_message:00000078 $d
                            *COM*:00000002 crc
                            *COM*:00000014 param
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:266    .text.process_queue:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:273    .text.process_queue:00000000 process_queue
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:366    .text.process_queue:00000040 $d
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:372    .text.read:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:379    .text.read:00000000 read
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:392    .text.write:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:399    .text.write:00000000 write
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:412    .text.reg_write:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:419    .text.reg_write:00000000 reg_write
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:432    .text.action:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:439    .text.action:00000000 action
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:452    .text.factory_reset:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:459    .text.factory_reset:00000000 factory_reset
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:472    .text.reboot:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:479    .text.reboot:00000000 reboot
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:492    .text.clear:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:499    .text.clear:00000000 clear
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:512    .text.status:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:519    .text.status:00000000 status
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:532    .text.sync_read:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:539    .text.sync_read:00000000 sync_read
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:552    .text.sync_write:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:559    .text.sync_write:00000000 sync_write
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:572    .text.bulk_read:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:579    .text.bulk_read:00000000 bulk_read
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:592    .text.bulk_write:00000000 $t
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:599    .text.bulk_write:00000000 bulk_write
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:628    .data.delay_transmit_uS:00000000 delay_transmit_uS
                            *COM*:00000001 rd_ptr
                            *COM*:00000020 txBuffer
                            *COM*:00000040 rxBuffer
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:619    .rodata:00000000 $d
C:\Users\Brandon\AppData\Local\Temp\ccospBEM.s:624    .data.delay_transmit_uS:00000000 $d

UNDEFINED SYMBOLS
transmit_buffer
DWT_Delay
deQueue
message
PARAM
isEmpty
